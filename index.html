<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>We Power On — Customisable UK Map (SVG)</title>

<!-- amCharts 5 (free tier). For commercial use, add your license key. -->
<script src="https://cdn.amcharts.com/lib/5/index.js"></script>
<script src="https://cdn.amcharts.com/lib/5/map.js"></script>
<script src="https://cdn.amcharts.com/lib/5/geodata/ukLow.js"></script>
<script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

<style>
  :root{
    /* Colours sampled to match your image */
    --sea: #b8e0e2;              /* background water */
    --scotland: #c75931;         /* SCOTLAND (rust) */
    --ni: #f2bc52;               /* NORTHERN IRELAND (yellow) */
    --wales: #c96a43;            /* WALES (orange) */
    --south-west: #667652;       /* SOUTH WEST (olive) */
    --north-west: #5d715e;       /* NORTH WEST (green) */
    --yorks-humber: #d9683e;     /* YORKS/HUMBER (orange-red) */
    --north-east: #f0c45b;       /* NORTH EAST (pale yellow) */
    --west-midlands: #8b4c3a;    /* WEST MIDLANDS (red-brown) */
    --east-midlands: #2f3d3e;    /* EAST MIDLANDS (very dark slate) */
    --east-england: #7a865b;     /* ANGLIA / East of England (olive) */
    --london: #30383a;           /* LONDON (charcoal) */
    --south-east: #f0b15c;       /* SOUTH EAST (yellow-orange) */

    --panel: #fff;
    --text: #0a0a0a;
    --accent: #FBBB3D;
  }

  *{ box-sizing:border-box; }
  html, body { height:100%; margin:0; }
  body{
    font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;
    color: var(--text);
    background: var(--panel);
  }

  /* Layout */
  .wrap{ display:grid; grid-template-columns: 340px 1fr; min-height:100dvh; }
  .sidebar{ padding:22px 18px; max-height:100dvh; overflow:auto; }
  h1{ margin:0 0 8px; font-size:clamp(26px,4vw,40px); font-weight:800; }
  p{ margin:0 0 10px; }

  #mapWrap{ background:var(--sea); border-left:1px solid #e5e7eb; }
  #chartdiv{ width:100%; height:100dvh; }

  /* Search & legend */
  .search{ position:sticky; top:8px; background:var(--panel); padding:8px 0 10px; z-index:2; }
  .search input{
    width:100%; border:2px solid var(--accent); background:var(--accent);
    color:#000; border-radius:8px; padding:10px 12px; font-size:15px; outline:none;
  }
  .search input::placeholder{ color:#222; }
  .legend{ margin-top:12px; display:grid; grid-template-columns:1fr 1fr; gap:8px 14px; }
  .chip{ display:flex; align-items:center; gap:8px; font-size:14px; }
  .swatch{ width:16px; height:16px; border-radius:3px; border:1px solid rgba(0,0,0,.25); }

  /* Popup look */
  .am5-layer .am5-tooltip{
    font-size:14px !important;
    padding:10px 12px !important;
    border-radius:10px !important;
    border:1px solid #ccc !important;
    box-shadow:0 8px 24px rgba(0,0,0,.18) !important;
    background:#fff !important;
    color:#000 !important;
  }

  @media (max-width: 900px){
    .wrap{ display:block; }
    #chartdiv{ height:65dvh; }
  }
</style>
</head>
<body>
  <main class="wrap">
    <aside class="sidebar">
      <h1>MEN'S WALK &amp; TALK MAP</h1>
      <p>Dynamic SVG map of the UK with editable colours and clickable markers. No image drift, fully responsive.</p>

      <div class="search">
        <input id="walkSearch" type="search" placeholder="Search walks… (e.g., London, Cardiff)">
      </div>

      <!-- legend auto-filled by JS -->
      <div id="legend" class="legend" aria-label="Region colours"></div>
      <p style="margin-top:14px;font-size:12px;color:#444;">
        Click a region to zoom. Click a marker to open its link. Press “Home” to reset.
      </p>
    </aside>

    <section id="mapWrap">
      <div id="chartdiv" role="application" aria-label="Customisable UK map"></div>
    </section>
  </main>

<script>
/* =========================
   Region colour mapping
   (matches your image)
   ========================= */
const REGION_COLORS = {
  // Countries
  "Scotland": getComputedStyle(document.documentElement).getPropertyValue("--scotland").trim(),
  "Wales": getComputedStyle(document.documentElement).getPropertyValue("--wales").trim(),
  "Northern Ireland": getComputedStyle(document.documentElement).getPropertyValue("--ni").trim(),
  "England": getComputedStyle(document.documentElement).getPropertyValue("--east-england").trim(), // fallback for any English polygons

  // English regions
  "South West": getComputedStyle(document.documentElement).getPropertyValue("--south-west").trim(),
  "South East": getComputedStyle(document.documentElement).getPropertyValue("--south-east").trim(),
  "London": getComputedStyle(document.documentElement).getPropertyValue("--london").trim(),
  "East of England": getComputedStyle(document.documentElement).getPropertyValue("--east-england").trim(), // Anglia in your art
  "East Midlands": getComputedStyle(document.documentElement).getPropertyValue("--east-midlands").trim(),
  "West Midlands": getComputedStyle(document.documentElement).getPropertyValue("--west-midlands").trim(),
  "North West": getComputedStyle(document.documentElement).getPropertyValue("--north-west").trim(),
  "Yorkshire and the Humber": getComputedStyle(document.documentElement).getPropertyValue("--yorks-humber").trim(),
  "North East": getComputedStyle(document.documentElement).getPropertyValue("--north-east").trim()
};

/* =========================
   Walk markers (lat/lng)
   ========================= */
const WALKS = [
  // England
  { id:"epsom",      name:"We Power On",           place:"Epsom, Surrey",     lat:51.334, lng:-0.266, url:"https://www.wepoweron.co.uk" },
  { id:"canterbury", name:"Mindful Steps",         place:"Canterbury, Kent",  lat:51.280, lng: 1.080, url:"https://www.wepoweron.co.uk" },
  { id:"birmingham", name:"Men's Brew Walk",       place:"Birmingham, West Midlands", lat:52.486, lng:-1.890, url:"https://www.wepoweron.co.uk" },
  { id:"london",     name:"River Walkers",         place:"London",            lat:51.507, lng:-0.128, url:"https://www.wepoweron.co.uk" },
  { id:"manchester", name:"Urban Stride",          place:"Manchester",        lat:53.480, lng:-2.242, url:"https://www.wepoweron.co.uk" },
  { id:"liverpool",  name:"Dockside Steps",        place:"Liverpool",         lat:53.407, lng:-2.991, url:"https://www.wepoweron.co.uk" },

  // Wales
  { id:"cardiff",    name:"Walk & Talk Cymru",     place:"Cardiff",           lat:51.481, lng:-3.179, url:"https://www.wepoweron.co.uk" },
  { id:"swansea",    name:"Coastal Strides",       place:"Swansea",           lat:51.621, lng:-3.943, url:"https://www.wepoweron.co.uk" },
  { id:"bangor_wales", name:"Mountain Trekkers",   place:"Bangor, Gwynedd",   lat:53.230, lng:-4.130, url:"https://www.wepoweron.co.uk" },
  { id:"newport_wales", name:"Friendship Walk",    place:"Newport",           lat:51.586, lng:-3.000, url:"https://www.wepoweron.co.uk" },
  { id:"wrexham",    name:"Green Steps",           place:"Wrexham",           lat:53.046, lng:-2.993, url:"https://www.wepoweron.co.uk" },
  { id:"aberystwyth",name:"Sea Breeze Walk",       place:"Aberystwyth",       lat:52.415, lng:-4.082, url:"https://www.wepoweron.co.uk" },

  // Scotland
  { id:"edinburgh",  name:"Highland Strides",      place:"Edinburgh",         lat:55.953, lng:-3.188, url:"https://www.wepoweron.co.uk" },
  { id:"glasgow",    name:"Clyde Walkers",         place:"Glasgow",           lat:55.864, lng:-4.251, url:"https://www.wepoweron.co.uk" },
  { id:"aberdeen_scot", name:"Coastal Trekkers",   place:"Aberdeen",          lat:57.149, lng:-2.094, url:"https://www.wepoweron.co.uk" },
  { id:"dundee",     name:"Riverside Steps",       place:"Dundee",            lat:56.462, lng:-2.970, url:"https://www.wepoweron.co.uk" },
  { id:"inverness",  name:"Lochside Strides",      place:"Inverness",         lat:57.477, lng:-4.224, url:"https://www.wepoweron.co.uk" },
  { id:"stirling",   name:"Castle Path Walk",      place:"Stirling",          lat:56.116, lng:-3.936, url:"https://www.wepoweron.co.uk" },

  // Northern Ireland
  { id:"belfast",    name:"Men's Cavehill Walking Club", place:"Belfast, Cavehill", lat:54.597, lng:-5.930, url:"https://www.facebook.com/p/Mens-Cavehill-Walking-Club-100086241889121/?locale=en_GB" },
  { id:"derry",      name:"Riverfront Walkers",    place:"Derry / Londonderry", lat:54.997, lng:-7.309, url:"https://www.wepoweron.co.uk" },
  { id:"lisburn",    name:"Step Together",         place:"Lisburn",            lat:54.514, lng:-6.036, url:"https://www.wepoweron.co.uk" },
  { id:"newry",      name:"Hill Trekkers",         place:"Newry",              lat:54.175, lng:-6.339, url:"https://www.wepoweron.co.uk" },
  { id:"armagh",     name:"Orchard Strides",       place:"Armagh",             lat:54.350, lng:-6.650, url:"https://www.wepoweron.co.uk" },
  { id:"bangor_ni",  name:"Coastal Breeze Walk",   place:"Bangor (NI)",        lat:54.660, lng:-5.670, url:"https://www.wepoweron.co.uk" },
];

/* =========================
   Map initialisation
   ========================= */
am5.ready(function() {
  const root = am5.Root.new("chartdiv");
  root.setThemes([ am5themes_Animated.new(root) ]);

  const chart = root.container.children.push(am5map.MapChart.new(root, {
    panX: "translateX",
    panY: "translateY",
    wheelY: "zoom",
    projection: am5map.geoMercator()
  }));

  // UK polygons
  const polygons = chart.series.push(am5map.MapPolygonSeries.new(root, {
    geoJSON: am5geodata_ukLow,
    valueField: "value",
    calculateAggregates: true
  }));

  polygons.mapPolygons.template.setAll({
    tooltipText: "{name}",
    interactive: true,
    stroke: am5.color(0xffffff),
    strokeOpacity: 0.9,
    strokeWidth: 0.5
  });

  // Fill each feature using our palette
  polygons.mapPolygons.template.adapters.add("fill", (fill, target) => {
    const name = target.dataItem.dataContext.name;
    const color = REGION_COLORS[name];
    if (color) return am5.color(color);
    // Some features in ukLow are counties/unitaries. Infer by their "country" parent.
    const parent = (target.dataItem.dataContext.properties || {}).country;
    if (parent && REGION_COLORS[parent]) return am5.color(REGION_COLORS[parent]);
    // Fallback for anything we missed (England counties, small islands)
    return am5.color(getComputedStyle(document.documentElement).getPropertyValue("--east-england").trim());
  });

  polygons.mapPolygons.template.states.create("hover", { scale: 1.01, fillOpacity: 0.92 });

  // Click-to-zoom behaviour
  polygons.mapPolygons.template.events.on("click", (ev) => {
    chart.zoomToGeoBounds(ev.target.dataItem.get("geoBounds"), 1.8, true);
  });

  // Home button
  const home = chart.children.push(am5.Button.new(root, {
    x: am5.p0, y: am5.p0, centerX: am5.p0, centerY: am5.p0,
    paddingTop: 8, paddingRight: 10, paddingBottom: 8, paddingLeft: 10,
    label: am5.Label.new(root, { text: "Home" })
  }));
  home.events.on("click", () => chart.goHome());

  // Markers (pins)
  const points = chart.series.push(am5map.MapPointSeries.new(root, {}));

  // Simple pin graphic (black body, accent stroke to echo your icon)
  function makePin(){
    return am5.Graphics.new(root, {
      svgPath: "M14 0c7.7 0 14 6.3 14 14 0 10.4-14 25-14 25S0 24.4 0 14C0 6.3 6.3 0 14 0Z",
      fill: am5.color("#000"),
      stroke: am5.color(getComputedStyle(document.documentElement).getPropertyValue("--accent").trim()),
      strokeWidth: 4
    });
  }

  WALKS.forEach(w => {
    const d = points.pushDataItem({ latitude: w.lat, longitude: w.lng });
    d.bullets.push(() => am5.Bullet.new(root, { sprite: makePin() }));
    d.set("tooltipText", `${w.name}\n${w.place}\nClick to open`);
    d.events.on("click", () => window.open(w.url, "_blank", "noopener"));
  });

  // Search (Enter to fly to first result)
  const searchEl = document.getElementById("walkSearch");
  searchEl.addEventListener("keydown", (e)=>{
    if(e.key !== "Enter") return;
    const q = searchEl.value.trim().toLowerCase();
    if(!q) return;
    const m = WALKS.find(w => (`${w.name} ${w.place}`).toLowerCase().includes(q));
    if(m){ chart.zoomToGeoPoint({latitude:m.lat, longitude:m.lng}, 8, true); }
  });

  // Build legend from REGION_COLORS
  const legend = document.getElementById("legend");
  Object.entries(REGION_COLORS).forEach(([label, hex])=>{
    const row = document.createElement("div");
    row.className = "chip";
    row.innerHTML = `<span class="swatch" style="background:${hex}"></span><span>${label}</span>`;
    legend.appendChild(row);
  });

  // Initial view
  chart.set("zoomStep", 2);
  chart.goHome();
});
</script>
</body>
</html>
